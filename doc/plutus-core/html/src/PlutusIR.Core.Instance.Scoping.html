<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans       #-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusIR.Core.Instance.Scoping</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html"><span class="hs-identifier">PlutusIR.Core.Type</span></a></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html"><span class="hs-identifier">PlutusCore.Check.Scoping</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.MkPlc.html"><span class="hs-identifier">PlutusCore.MkPlc</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html"><span class="hs-identifier">PlutusCore.Quote</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator">(&lt;|)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Traversable</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100387"><span id="local-6989586621681100388"><span id="local-6989586621681100389"><span id="local-6989586621681100390"><span class="annot"><a href="#local-6989586621681100390"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100390"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100389"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100388"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100387"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>    </span><span id="local-6989586621681100083"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; Term tyname name uni fun NameAnn
-&gt; Term tyname name uni fun NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100081"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100081"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100080"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100080"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span id="local-6989586621681100079"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100079"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100079"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100081"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100080"><span class="hs-identifier hs-var">tyname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100080"><span class="hs-identifier hs-var">tyname</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100366"><span id="local-6989586621681100367"><span id="local-6989586621681100368"><span id="local-6989586621681100369"><span class="annot"><a href="#local-6989586621681100369"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100368"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100369"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100367"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100366"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>    </span><span id="local-6989586621681100069"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Name
-&gt; Term tyname name uni fun NameAnn
-&gt; Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100069"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100068"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100068"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100067"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100067"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681100066"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100066"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100066"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100068"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100067"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100067"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100359"><span id="local-6989586621681100360"><span id="local-6989586621681100361"><span class="annot"><a href="#local-6989586621681100361"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100361"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100360"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100359"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>    </span><span id="local-6989586621681100055"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; VarDecl tyname name uni NameAnn
-&gt; VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681100055"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100054"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100054"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100053"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100053"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681100051"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100051"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100050"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100050"><span class="hs-identifier hs-var">varName</span></a></span></span><span> </span><span id="local-6989586621681100049"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681100049"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100051"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100050"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100054"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100053"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681100049"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Scoping for data types is hard, so we employ some extra paranoia and reference the provided</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- 'TyName' in the type of every single constructor, and also apply the final head to that 'TyName'.</span><span>
</span><span id="line-33"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100345"><span id="local-6989586621681100346"><span id="local-6989586621681100347"><span class="annot"><a href="#local-6989586621681100347"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100347"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100346"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100345"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>    </span><span id="local-6989586621681100041"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; Datatype tyname name uni NameAnn
-&gt; Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681100041"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100040"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100040"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100039"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100039"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span id="local-6989586621681100037"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100037"><span class="hs-identifier hs-var">dataAnn</span></a></span></span><span> </span><span id="local-6989586621681100036"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681100036"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681100035"><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681100035"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681100034"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100034"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681100033"><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681100033"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) a.
a
-&gt; TyVarDecl tyname a
-&gt; [TyVarDecl tyname a]
-&gt; name
-&gt; [VarDecl tyname name uni a]
-&gt; Datatype tyname name uni a
</span><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-var">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100037"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681100036"><span class="hs-identifier hs-var">dataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681100035"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100034"><span class="hs-identifier hs-var">matchName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl TyName name uni NameAnn -&gt; VarDecl TyName name uni NameAnn
</span><a href="#local-6989586621681100032"><span class="hs-identifier hs-var">goConstr</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681100033"><span class="hs-identifier hs-var">constrs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>            </span><span id="local-6989586621681100031"><span class="annot"><span class="annottext">tyVar :: Type TyName uni NameAnn
</span><a href="#local-6989586621681100031"><span class="hs-identifier hs-var hs-var">tyVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100040"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100039"><span class="hs-identifier hs-var">tyname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100039"><span class="hs-identifier hs-var">tyname</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>            </span><span id="local-6989586621681100032"><span class="annot"><span class="annottext">goConstr :: VarDecl TyName name uni NameAnn -&gt; VarDecl TyName name uni NameAnn
</span><a href="#local-6989586621681100032"><span class="hs-identifier hs-var hs-var">goConstr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681100030"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100030"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100029"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100029"><span class="hs-identifier hs-var">constrName</span></a></span></span><span> </span><span id="local-6989586621681100028"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100028"><span class="hs-identifier hs-var">constrTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100030"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100029"><span class="hs-identifier hs-var">constrName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100028"><span class="hs-identifier hs-var">constrTy</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>            </span><span id="local-6989586621681100027"><span class="annot"><span class="annottext">goSpine :: Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100027"><span class="hs-identifier hs-var hs-var">goSpine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-type">TyForall</span></a></span><span> </span><span id="local-6989586621681100025"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100025"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100024"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100024"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681100023"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681100023"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681100022"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100022"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; tyname -&gt; Kind ann -&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-var">TyForall</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100025"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100024"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681100023"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100022"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-41"></span><span>            </span><span class="annot"><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-type">TyFun</span></a></span><span> </span><span id="local-6989586621681100020"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100020"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100019"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100019"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681100018"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100018"><span class="hs-identifier hs-var">cod</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100020"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100019"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100018"><span class="hs-identifier hs-var">cod</span></a></span><span>
</span><span id="line-42"></span><span>            </span><span class="annot"><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span id="local-6989586621681100017"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100017"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100031"><span class="hs-identifier hs-var">tyVar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100016"><span class="hs-identifier hs-var">goResult</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100017"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>            </span><span id="local-6989586621681100016"><span class="annot"><span class="annottext">goResult :: Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100016"><span class="hs-identifier hs-var hs-var">goResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-type">TyApp</span></a></span><span> </span><span id="local-6989586621681100014"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100014"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100013"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100013"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681100012"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100012"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-var">TyApp</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100014"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100016"><span class="hs-identifier hs-var">goResult</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100013"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100012"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-45"></span><span>            </span><span class="annot"><a href="#local-6989586621681100016"><span class="hs-identifier hs-var">goResult</span></a></span><span> </span><span id="local-6989586621681100011"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100011"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-var">TyApp</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100011"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100031"><span class="hs-identifier hs-var">tyVar</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100328"><span id="local-6989586621681100329"><span id="local-6989586621681100330"><span id="local-6989586621681100331"><span class="annot"><a href="#local-6989586621681100331"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100331"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100330"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100329"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100328"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621681099997"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; Binding tyname name uni fun NameAnn
-&gt; Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681099997"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681099996"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099996"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681099995"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099995"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span id="local-6989586621681099993"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099993"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099992"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681099992"><span class="hs-identifier hs-var">strictness</span></a></span></span><span> </span><span id="local-6989586621681099991"><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099991"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span id="local-6989586621681099990"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099990"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099993"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681099992"><span class="hs-identifier hs-var">strictness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099996"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099995"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099991"><span class="hs-identifier hs-var">varDecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099996"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099995"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099990"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681099985"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099985"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681099984"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099984"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span id="local-6989586621681099982"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099982"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099981"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099981"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span id="local-6989586621681099980"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099980"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099982"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099981"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099985"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099984"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099980"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681099977"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099977"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681099976"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099976"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span id="local-6989586621681099974"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099974"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099973"><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681099973"><span class="hs-identifier hs-var">datatype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099974"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099977"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099976"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681099973"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Unlike other 'Reference' instances this one does not guarantee that the name will actually be</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- referenced, but it's too convenient to have this instance to give up on it, without it would be</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- awkward to express \&quot;reference this binding in this thing\&quot;.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100310"><span id="local-6989586621681100311"><span id="local-6989586621681100312"><span id="local-6989586621681100313"><span class="annot"><a href="#local-6989586621681100313"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100312"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100313"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100311"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100310"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621681099963"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Name
-&gt; Binding tyname name uni fun NameAnn
-&gt; Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681099963"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681099962"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099962"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681099961"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099961"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span id="local-6989586621681099960"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099960"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099959"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681099959"><span class="hs-identifier hs-var">strictness</span></a></span></span><span> </span><span id="local-6989586621681099958"><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099958"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span id="local-6989586621681099957"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099957"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099960"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681099959"><span class="hs-identifier hs-var">strictness</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099958"><span class="hs-identifier hs-var">varDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099962"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099961"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099957"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099954"><span class="annot"><span class="annottext">typeBind :: Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681099954"><span class="hs-identifier hs-var">typeBind</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681099954"><span class="hs-identifier hs-var">typeBind</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099953"><span class="annot"><span class="annottext">datatypeBind :: Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681099953"><span class="hs-identifier hs-var">datatypeBind</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681099953"><span class="hs-identifier hs-var">datatypeBind</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100303"><span id="local-6989586621681100304"><span id="local-6989586621681100305"><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100305"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100304"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100305"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100303"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100304"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621681099948"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyVarDecl tyname ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681099948"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681099947"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099947"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099947"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname ann. TyVarDecl tyname ann -&gt; tyname
</span><a href="PlutusCore.Core.Type.html#_tyVarDeclName"><span class="hs-identifier hs-var">_tyVarDeclName</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100287"><span id="local-6989586621681100288"><span id="local-6989586621681100289"><span id="local-6989586621681100290"><span id="local-6989586621681100291"><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100291"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100290"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100289"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100291"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100288"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100287"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100290"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621681099938"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; VarDecl tyname name uni ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681099938"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681099937"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099937"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099937"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; name
</span><a href="PlutusCore.Core.Type.html#_varDeclName"><span class="hs-identifier hs-var">_varDeclName</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100276"><span id="local-6989586621681100277"><span id="local-6989586621681100278"><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100278"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100278"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100277"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100276"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100278"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621681099923"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Datatype TyName Name uni ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681099923"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681099922"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099922"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099921"><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681099921"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681099920"><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681099920"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681099919"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099919"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681099918"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099918"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099922"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681099921"><span class="hs-identifier hs-var">dataDecl</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-comment">-- Parameters of a data type are not visible outside of the data type no matter what.</span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceOutOfScope"><span class="hs-identifier hs-var">referenceOutOfScope</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681099920"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099922"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099919"><span class="hs-identifier hs-var">matchName</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099922"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099918"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100261"><span id="local-6989586621681100262"><span id="local-6989586621681100263"><span id="local-6989586621681100264"><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100264"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100264"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100263"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100262"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100261"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100264"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621681099903"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Binding TyName Name uni fun ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681099903"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681099902"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099902"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099901"><span class="annot"><span class="annottext">VarDecl TyName Name uni ann
</span><a href="#local-6989586621681099901"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099902"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl TyName Name uni ann
</span><a href="#local-6989586621681099901"><span class="hs-identifier hs-var">varDecl</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681099898"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099898"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099897"><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681099897"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099898"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681099897"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681099894"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099894"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099893"><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681099893"><span class="hs-identifier hs-var">datatype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099894"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681099893"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Establish scoping for each of the parameters of a datatype by only annotating every parameter</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- with 'introduceBound'.</span><span>
</span><span id="line-85"></span><span id="local-6989586621681100257"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingParams"><span class="hs-identifier hs-type">establishScopingParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100257"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-86"></span><span id="establishScopingParams"><span class="annot"><span class="annottext">establishScopingParams :: forall ann.
[TyVarDecl TyName ann] -&gt; Quote [TyVarDecl TyName NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingParams"><span class="hs-identifier hs-var hs-var">establishScopingParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099870"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099870"><span class="hs-identifier hs-var">paramNameDup</span></a></span></span><span> </span><span id="local-6989586621681099869"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099869"><span class="hs-identifier hs-var">paramKind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621681099868"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099868"><span class="hs-identifier hs-var">paramName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099870"><span class="hs-identifier hs-var">paramNameDup</span></a></span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">forall tyname ann.
ann -&gt; tyname -&gt; Kind ann -&gt; TyVarDecl tyname ann
</span><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-var">TyVarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099868"><span class="hs-identifier hs-var">paramName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099868"><span class="hs-identifier hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099869"><span class="hs-identifier hs-var">paramKind</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- See Note [Weird IR data types].</span><span>
</span><span id="line-92"></span><span class="hs-comment">{- | Establish scoping for the type of a constructor. The updated constructor expects an argument
of the \&quot;the data type applied to all its parameters\&quot; type (that argument is the last one) and
always returns that exact type as a result. For example, this functions turns the following
generated type of constructor

    integer -&gt; a -&gt; &lt;a_non_-&gt;_type&gt;

into

    integer -&gt; a -&gt; D a b -&gt; D a b

assuming the constructor is supposed to construct a data type @D@ parameterized by two parameters
@a@ and @b@. Note that @&lt;a_non_-&gt;_type&gt;@ can be anything as the generator is allowed to generate
mess such as a constructor not actually constructing a value of the data type.

Whether the name of the data type is referenced as in-scope or out-of-scope one in the types of
arguments of constructors is controlled by the first argument, which ultimately depends on the
recursivity of the data type.
-}</span><span>
</span><span id="line-111"></span><span id="local-6989586621681100233"><span id="local-6989586621681100234"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrTy"><span class="hs-identifier hs-type">establishScopingConstrTy</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100234"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100233"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100234"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-117"></span><span id="establishScopingConstrTy"><span class="annot"><span class="annottext">establishScopingConstrTy :: forall (uni :: * -&gt; *) ann.
(TyName -&gt; NameAnn)
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; Type TyName uni ann
-&gt; Quote (Type TyName uni NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrTy"><span class="hs-identifier hs-var hs-var">establishScopingConstrTy</span></a></span></span><span> </span><span id="local-6989586621681099844"><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681099844"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span id="local-6989586621681099843"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099843"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621681099842"><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099842"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681099841"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621681099840"><span class="annot"><span class="annottext">toDataAppliedToParams :: (TyName -&gt; NameAnn) -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681099840"><span class="hs-identifier hs-var hs-var">toDataAppliedToParams</span></a></span></span><span> </span><span id="local-6989586621681099839"><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681099839"><span class="hs-identifier hs-var">reg</span></a></span></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann tyname (uni :: * -&gt; *).
ann
-&gt; Type tyname uni ann
-&gt; [Type tyname uni ann]
-&gt; Type tyname uni ann
</span><a href="PlutusCore.MkPlc.html#mkIterTyApp"><span class="hs-identifier hs-var">mkIterTyApp</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681099839"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099843"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099843"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099837"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099837"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099837"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099837"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099842"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621681099841"><span class="annot"><span class="annottext">goSpine :: Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681099841"><span class="hs-identifier hs-var hs-var">goSpine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-type">TyForall</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099835"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099835"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681099834"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099834"><span class="hs-identifier hs-var">kindDup</span></a></span></span><span> </span><span id="local-6989586621681099833"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099833"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-comment">-- Similar to 'establishScopingBinder', but uses 'TyFun' rather than whatever 'registerVia'</span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-comment">-- uses in order not to break the invariants described in Note [Weird IR data types].</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-comment">-- Also calls 'goSpine' recursively rather than 'establishScoping'.</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621681099832"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099835"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621681099831"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099831"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099834"><span class="hs-identifier hs-var">kindDup</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerOutOfScope"><span class="hs-identifier hs-var">registerOutOfScope</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-129"></span><span>            </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; tyname -&gt; Kind ann -&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-var">TyForall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099831"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-130"></span><span>                </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099832"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="annottext">Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681099841"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099833"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621681099841"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-type">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099829"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099829"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681099828"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099828"><span class="hs-identifier hs-var">cod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099829"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681099841"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099828"><span class="hs-identifier hs-var">cod</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="#local-6989586621681099841"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyName -&gt; NameAnn) -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681099840"><span class="hs-identifier hs-var">toDataAppliedToParams</span></a></span><span> </span><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681099844"><span class="hs-identifier hs-var">regSelf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TyName -&gt; NameAnn) -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681099840"><span class="hs-identifier hs-var">toDataAppliedToParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Establish scoping for all constructors of a data type by establishing scoping for each of them</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- individually. If there are no constructors, then a dummy one is added, because we need to</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- maintain the invariant that every binding is referenced as an in-scope one somewhere and the only</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- place where parameters of a data type can be referenced this way is a constructor of that data</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-141"></span><span id="local-6989586621681100220"><span id="local-6989586621681100221"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrs"><span class="hs-identifier hs-type">establishScopingConstrs</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100221"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100220"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100221"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100220"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-148"></span><span id="establishScopingConstrs"><span class="annot"><span class="annottext">establishScopingConstrs :: forall ann (uni :: * -&gt; *).
(TyName -&gt; NameAnn)
-&gt; ann
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; [VarDecl TyName Name uni ann]
-&gt; Quote [VarDecl TyName Name uni NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrs"><span class="hs-identifier hs-var hs-var">establishScopingConstrs</span></a></span></span><span> </span><span id="local-6989586621681099812"><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681099812"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span id="local-6989586621681099811"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681099811"><span class="hs-identifier hs-var">dataAnn</span></a></span></span><span> </span><span id="local-6989586621681099810"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099810"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621681099809"><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099809"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681099808"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099808"><span class="hs-identifier hs-var">constrsPossiblyEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621681099807"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099807"><span class="hs-identifier hs-var">cons0Name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshName"><span class="hs-identifier hs-var">freshName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cons0&quot;</span></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681099805"><span class="annot"><span class="annottext">cons0 :: VarDecl TyName Name uni ann
</span><a href="#local-6989586621681099805"><span class="hs-identifier hs-var hs-var">cons0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681099811"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099807"><span class="hs-identifier hs-var">cons0Name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681099811"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099810"><span class="hs-identifier hs-var">dataName</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span id="local-6989586621681099804"><span class="annot"><span class="annottext">constrs :: [VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099804"><span class="hs-identifier hs-var hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099808"><span class="hs-identifier hs-var">constrsPossiblyEmpty</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VarDecl TyName Name uni ann
</span><a href="#local-6989586621681099805"><span class="hs-identifier hs-var">cons0</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099808"><span class="hs-identifier hs-var">constrsPossiblyEmpty</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099804"><span class="hs-identifier hs-var">constrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099801"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099801"><span class="hs-identifier hs-var">constrNameDup</span></a></span></span><span> </span><span id="local-6989586621681099800"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099800"><span class="hs-identifier hs-var">constrTyDup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>        </span><span id="local-6989586621681099799"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099799"><span class="hs-identifier hs-var">constrName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099801"><span class="hs-identifier hs-var">constrNameDup</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span id="local-6989586621681099797"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681099797"><span class="hs-identifier hs-var">constrTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) ann.
(TyName -&gt; NameAnn)
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; Type TyName uni ann
-&gt; Quote (Type TyName uni NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrTy"><span class="hs-identifier hs-var">establishScopingConstrTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681099812"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099810"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099809"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099800"><span class="hs-identifier hs-var">constrTyDup</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099799"><span class="hs-identifier hs-var">constrName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099799"><span class="hs-identifier hs-var">constrName</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681099797"><span class="hs-identifier hs-var">constrTy</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Establish scoping of a binding. Each bindings gets referenced in its own body either as an</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- in-scope or out-of-scope one, which is controlled by the first argument and ultimately depends on</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- the recursivity of the binding.</span><span>
</span><span id="line-160"></span><span id="local-6989586621681100206"><span id="local-6989586621681100207"><span id="local-6989586621681100208"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-type">establishScopingBinding</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681099795"><span class="annot"><a href="#local-6989586621681099795"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099795"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681099795"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100208"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100207"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100206"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100208"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100207"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-164"></span><span id="establishScopingBinding"><span class="annot"><span class="annottext">establishScopingBinding :: forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Binding TyName Name uni fun ann
-&gt; Quote (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var hs-var">establishScopingBinding</span></a></span></span><span> </span><span id="local-6989586621681099755"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099755"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099754"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681099754"><span class="hs-identifier hs-var">strictness</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099753"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099753"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681099752"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099752"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681099751"><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681099751"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621681099750"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099750"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099753"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621681099749"><span class="annot"><span class="annottext">VarDecl TyName Name uni NameAnn
</span><a href="#local-6989586621681099749"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099750"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099750"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099752"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681099754"><span class="hs-identifier hs-var">strictness</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl TyName Name uni NameAnn
</span><a href="#local-6989586621681099749"><span class="hs-identifier hs-var">varDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099755"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099750"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681099751"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var">establishScopingBinding</span></a></span><span> </span><span id="local-6989586621681099746"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099746"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099745"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099745"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681099744"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099744"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681099743"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099743"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621681099742"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099742"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099745"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621681099741"><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681099741"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tyname ann.
ann -&gt; tyname -&gt; Kind ann -&gt; TyVarDecl tyname ann
</span><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-var">TyVarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099742"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099742"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099744"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681099741"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099746"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099742"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681099743"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-172"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var">establishScopingBinding</span></a></span><span> </span><span id="local-6989586621681099738"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099738"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span id="local-6989586621681099737"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681099737"><span class="hs-identifier hs-var">dataAnn</span></a></span></span><span> </span><span id="local-6989586621681099736"><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681099736"><span class="hs-identifier hs-var">datatypeDup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099735"><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681099735"><span class="hs-identifier hs-var">dataDeclDup</span></a></span></span><span> </span><span id="local-6989586621681099734"><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681099734"><span class="hs-identifier hs-var">paramsDup</span></a></span></span><span> </span><span id="local-6989586621681099733"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099733"><span class="hs-identifier hs-var">matchNameDup</span></a></span></span><span> </span><span id="local-6989586621681099732"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099732"><span class="hs-identifier hs-var">constrsDup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681099736"><span class="hs-identifier hs-var">datatypeDup</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099731"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099731"><span class="hs-identifier hs-var">dataNameDup</span></a></span></span><span> </span><span id="local-6989586621681099730"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099730"><span class="hs-identifier hs-var">dataKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681099735"><span class="hs-identifier hs-var">dataDeclDup</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621681099729"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099729"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099731"><span class="hs-identifier hs-var">dataNameDup</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621681099728"><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681099728"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tyname ann.
ann -&gt; tyname -&gt; Kind ann -&gt; TyVarDecl tyname ann
</span><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-var">TyVarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099729"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099729"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099730"><span class="hs-identifier hs-var">dataKind</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621681099727"><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099727"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ann.
[TyVarDecl TyName ann] -&gt; Quote [TyVarDecl TyName NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingParams"><span class="hs-identifier hs-var">establishScopingParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681099734"><span class="hs-identifier hs-var">paramsDup</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621681099726"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099726"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099733"><span class="hs-identifier hs-var">matchNameDup</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621681099725"><span class="annot"><span class="annottext">[VarDecl TyName Name uni NameAnn]
</span><a href="#local-6989586621681099725"><span class="hs-identifier hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ann (uni :: * -&gt; *).
(TyName -&gt; NameAnn)
-&gt; ann
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; [VarDecl TyName Name uni ann]
-&gt; Quote [VarDecl TyName Name uni NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrs"><span class="hs-identifier hs-var">establishScopingConstrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099738"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681099737"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099729"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099727"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681099732"><span class="hs-identifier hs-var">constrsDup</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681099724"><span class="annot"><span class="annottext">datatype :: Datatype TyName Name uni NameAnn
</span><a href="#local-6989586621681099724"><span class="hs-identifier hs-var hs-var">datatype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) a.
a
-&gt; TyVarDecl tyname a
-&gt; [TyVarDecl tyname a]
-&gt; name
-&gt; [VarDecl tyname name uni a]
-&gt; Datatype tyname name uni a
</span><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-var">Datatype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099726"><span class="hs-identifier hs-var">matchName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681099728"><span class="hs-identifier hs-var">dataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681099727"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099726"><span class="hs-identifier hs-var">matchName</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni NameAnn]
</span><a href="#local-6989586621681099725"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype TyName Name uni NameAnn
</span><a href="#local-6989586621681099724"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Reference each binding in the last one apart from itself.</span><span>
</span><span id="line-184"></span><span id="local-6989586621681100195"><span id="local-6989586621681100196"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-type">referenceViaBindings</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681099722"><span class="annot"><a href="#local-6989586621681099722"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099722"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681099722"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100196"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100195"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100196"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100195"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-188"></span><span id="referenceViaBindings"><span class="annot"><span class="annottext">referenceViaBindings :: forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var hs-var">referenceViaBindings</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621681099715"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099715"><span class="hs-identifier hs-var">b0</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099715"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var">referenceViaBindings</span></a></span><span> </span><span id="local-6989586621681099714"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099714"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681099713"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099713"><span class="hs-identifier hs-var">b0</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621681099712"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099712"><span class="hs-identifier hs-var">bs0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
-&gt; Binding TyName Name uni fun NameAnn
-&gt; [Binding TyName Name uni fun NameAnn]
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099711"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099713"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099712"><span class="hs-identifier hs-var">bs0</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621681099711"><span class="annot"><span class="annottext">go :: [Binding TyName Name uni fun NameAnn]
-&gt; Binding TyName Name uni fun NameAnn
-&gt; [Binding TyName Name uni fun NameAnn]
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099711"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681099710"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099710"><span class="hs-identifier hs-var">prevs</span></a></span></span><span> </span><span id="local-6989586621681099709"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099709"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099714"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099710"><span class="hs-identifier hs-var">prevs</span></a></span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099709"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="#local-6989586621681099711"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681099706"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099706"><span class="hs-identifier hs-var">prevs</span></a></span></span><span> </span><span id="local-6989586621681099705"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099705"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681099704"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099704"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681099703"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099703"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099705"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
-&gt; Binding TyName Name uni fun NameAnn
-&gt; [Binding TyName Name uni fun NameAnn]
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099711"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099705"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099706"><span class="hs-identifier hs-var">prevs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681099704"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681099703"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Reference each binding in the first one apart from itself and in the last one also apart from</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- itself. Former bindings are always visible in latter ones and whether latter bindings are visible</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- in former ones is controlled by the first argument and ultimately depends on the recursivity</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- of the family of bindings.</span><span>
</span><span id="line-197"></span><span id="local-6989586621681099701"><span id="local-6989586621681099702"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#referenceBindingsBothWays"><span class="hs-identifier hs-type">referenceBindingsBothWays</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681099699"><span class="annot"><a href="#local-6989586621681099699"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099699"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681099699"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099702"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099701"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099702"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099701"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-201"></span><span id="referenceBindingsBothWays"><span class="annot"><span class="annottext">referenceBindingsBothWays :: forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceBindingsBothWays"><span class="hs-identifier hs-var hs-var">referenceBindingsBothWays</span></a></span></span><span> </span><span id="local-6989586621681099698"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099698"><span class="hs-identifier hs-var">regRec</span></a></span></span><span>          </span><span class="hs-comment">-- Whether latter bindings are visible in former ones</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">NonEmpty.reverse</span></a></span><span>                    </span><span class="hs-comment">-- or not depends on the recursivity and so we have</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var">referenceViaBindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099698"><span class="hs-identifier hs-var">regRec</span></a></span><span>         </span><span class="hs-comment">-- the registering function as an argument.</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">NonEmpty.reverse</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var">referenceViaBindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span>  </span><span class="hs-comment">-- Former bindings are always visible in latter ones.</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Establish scoping for a family of bindings.</span><span>
</span><span id="line-208"></span><span id="local-6989586621681100182"><span id="local-6989586621681100183"><span id="local-6989586621681100184"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBindings"><span class="hs-identifier hs-type">establishScopingBindings</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681099691"><span class="annot"><a href="#local-6989586621681099691"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681099691"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681099691"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100184"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100183"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100182"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100184"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100183"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-212"></span><span id="establishScopingBindings"><span class="annot"><span class="annottext">establishScopingBindings :: forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun ann)
-&gt; Quote (NonEmpty (Binding TyName Name uni fun NameAnn))
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBindings"><span class="hs-identifier hs-var hs-var">establishScopingBindings</span></a></span></span><span> </span><span id="local-6989586621681099684"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099684"><span class="hs-identifier hs-var">regRec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- Note that mutual recursion and self-recursion are handled separately.</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceBindingsBothWays"><span class="hs-identifier hs-var">referenceBindingsBothWays</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099684"><span class="hs-identifier hs-var">regRec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Binding TyName Name uni fun ann
-&gt; Quote (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var">establishScopingBinding</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681099684"><span class="hs-identifier hs-var">regRec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Return a registering function depending on the recursivity.</span><span>
</span><span id="line-217"></span><span id="local-6989586621681100173"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-type">registerByRecursivity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100173"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Recursivity"><span class="hs-identifier hs-type">Recursivity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100173"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span></span><span>
</span><span id="line-218"></span><span id="registerByRecursivity"><span class="annot"><span class="annottext">registerByRecursivity :: forall name. ToScopedName name =&gt; Recursivity -&gt; name -&gt; NameAnn
</span><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-var hs-var">registerByRecursivity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-var">registerByRecursivity</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerOutOfScope"><span class="hs-identifier hs-var">registerOutOfScope</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100200"><span id="local-6989586621681100201"><span id="local-6989586621681100202"><span id="local-6989586621681100203"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100203"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100202"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#EstablishScoping"><span class="hs-identifier hs-type">EstablishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100203"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100202"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100201"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100200"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621681099604"><span class="annot"><span class="annottext">establishScoping :: forall ann.
Term tyname name uni fun ann
-&gt; Quote (Term tyname name uni fun NameAnn)
</span><a href="#local-6989586621681099604"><span class="hs-identifier hs-var hs-var hs-var hs-var">establishScoping</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099602"><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681099602"><span class="hs-identifier hs-var">recy</span></a></span></span><span> </span><span id="local-6989586621681099601"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681099601"><span class="hs-identifier hs-var">bindingsDup</span></a></span></span><span> </span><span id="local-6989586621681099600"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099600"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621681099599"><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099599"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun ann)
-&gt; Quote (NonEmpty (Binding TyName Name uni fun NameAnn))
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBindings"><span class="hs-identifier hs-var">establishScopingBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; Recursivity -&gt; name -&gt; NameAnn
</span><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-var">registerByRecursivity</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681099602"><span class="hs-identifier hs-var">recy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681099601"><span class="hs-identifier hs-var">bindingsDup</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-comment">-- Follows the shape of 'establishScopingBinder', but subtly differs (for example,</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-comment">-- does not bind a single name, does not have a @sort@ etc), hence we write things out</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-comment">-- manually.</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceOutOfScope"><span class="hs-identifier hs-var">referenceOutOfScope</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099599"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Recursivity
-&gt; NonEmpty (Binding tyname name uni fun a)
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681099602"><span class="hs-identifier hs-var">recy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099599"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-229"></span><span>                </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceBound"><span class="hs-identifier hs-var">referenceBound</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681099599"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-230"></span><span>                    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099600"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-type">LamAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099594"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099594"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681099593"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099593"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681099592"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099592"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>        </span><span id="local-6989586621681099591"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099591"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099594"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="annottext">forall name (value :: * -&gt; *) (sort :: * -&gt; *) ann.
(Reference name value, ToScopedName name, Scoping sort,
 Scoping value) =&gt;
(NameAnn -&gt; name -&gt; sort NameAnn -&gt; value NameAnn -&gt; value NameAnn)
-&gt; name -&gt; sort ann -&gt; value ann -&gt; Quote (value NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScopingBinder"><span class="hs-identifier hs-var">establishScopingBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; name
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099591"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099593"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099592"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-type">TyAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099588"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099588"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681099587"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099587"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681099586"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099586"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>        </span><span id="local-6989586621681099585"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099585"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099588"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="annottext">forall name (value :: * -&gt; *) (sort :: * -&gt; *) ann.
(Reference name value, ToScopedName name, Scoping sort,
 Scoping value) =&gt;
(NameAnn -&gt; name -&gt; sort NameAnn -&gt; value NameAnn -&gt; value NameAnn)
-&gt; name -&gt; sort ann -&gt; value ann -&gt; Quote (value NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScopingBinder"><span class="hs-identifier hs-var">establishScopingBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; tyname
-&gt; Kind a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681099585"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681099587"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099586"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-type">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099583"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099583"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681099582"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099582"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681099581"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099581"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099583"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099582"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099581"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099580"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099580"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681099579"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099579"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099580"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099579"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-type">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099577"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099577"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-var">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099577"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099575"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099575"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Type tyname uni a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099575"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-type">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099574"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099574"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681099573"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099573"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099574"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681099573"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099572"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099572"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621681099571"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099571"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099572"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerFree"><span class="hs-identifier hs-var">registerFree</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099571"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681099571"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099568"><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><a href="#local-6989586621681099568"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Some (ValueOf uni) -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><a href="#local-6989586621681099568"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099566"><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681099566"><span class="hs-identifier hs-var">bi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; fun -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-var">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681099566"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100140"><span id="local-6989586621681100141"><span id="local-6989586621681100142"><span id="local-6989586621681100143"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100143"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100142"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#EstablishScoping"><span class="hs-identifier hs-type">EstablishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100143"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100142"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100141"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100140"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621681099553"><span class="annot"><span class="annottext">establishScoping :: forall ann.
Program tyname name uni fun ann
-&gt; Quote (Program tyname name uni fun NameAnn)
</span><a href="#local-6989586621681099553"><span class="hs-identifier hs-var hs-var hs-var hs-var">establishScoping</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099551"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099551"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann.
ann
-&gt; Term tyname name uni fun ann -&gt; Program tyname name uni fun ann
</span><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681099551"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100130"><span class="annot"><a href="#local-6989586621681100130"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100130"><span class="hs-identifier hs-type">tyname</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621681099540"><span class="annot"><span class="annottext">collectScopeInfo :: TyVarDecl tyname NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span id="local-6989586621681099538"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099538"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099537"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099537"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span id="local-6989586621681099536"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099536"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099538"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099537"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099536"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100122"><span id="local-6989586621681100123"><span id="local-6989586621681100124"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100124"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100123"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100124"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100123"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100122"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621681099522"><span class="annot"><span class="annottext">collectScopeInfo :: VarDecl tyname name uni NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099522"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681099521"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099521"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099520"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099520"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681099519"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099519"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099521"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099520"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099519"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100116"><span id="local-6989586621681100117"><span id="local-6989586621681100118"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100118"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100117"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100118"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100117"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100116"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621681099496"><span class="annot"><span class="annottext">collectScopeInfo :: Datatype tyname name uni NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099496"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span id="local-6989586621681099495"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099495"><span class="hs-identifier hs-var">matchAnn</span></a></span></span><span> </span><span id="local-6989586621681099494"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099494"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681099493"><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681099493"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681099492"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099492"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681099491"><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681099491"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099494"><span class="hs-identifier hs-var">dataDecl</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681099493"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099495"><span class="hs-identifier hs-var">matchAnn</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099492"><span class="hs-identifier hs-var">matchName</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681099491"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100105"><span id="local-6989586621681100106"><span id="local-6989586621681100107"><span id="local-6989586621681100108"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100108"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100107"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100108"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100107"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100106"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100105"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621681099468"><span class="annot"><span class="annottext">collectScopeInfo :: Binding tyname name uni fun NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099468"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099467"><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099467"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span id="local-6989586621681099466"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099466"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099467"><span class="hs-identifier hs-var">varDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099466"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099465"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099465"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span id="local-6989586621681099464"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099464"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099465"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099464"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099463"><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681099463"><span class="hs-identifier hs-var">datatype</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681099463"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100157"><span id="local-6989586621681100158"><span id="local-6989586621681100159"><span id="local-6989586621681100160"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100160"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100159"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100160"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100159"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100158"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100157"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621681099418"><span class="annot"><span class="annottext">collectScopeInfo :: Term tyname name uni fun NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099418"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099417"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun NameAnn)
</span><a href="#local-6989586621681099417"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span id="local-6989586621681099416"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099416"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun NameAnn)
</span><a href="#local-6989586621681099417"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099416"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-type">LamAbs</span></a></span><span> </span><span id="local-6989586621681099415"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099415"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099414"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099414"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681099413"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099413"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681099412"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099412"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099415"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099414"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099413"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099412"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-type">TyAbs</span></a></span><span> </span><span id="local-6989586621681099411"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099411"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099410"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099410"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681099409"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099409"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681099408"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099408"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099411"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099410"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099409"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099408"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-type">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099407"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099407"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681099406"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099406"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681099405"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099405"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099407"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099406"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099405"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099404"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099404"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681099403"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099403"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099404"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099403"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-type">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099402"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099402"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099402"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099401"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099401"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099401"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-type">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099400"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099400"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681099399"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099399"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099400"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099399"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681099398"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099398"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099397"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099397"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099398"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099397"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">fun
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100092"><span id="local-6989586621681100093"><span id="local-6989586621681100094"><span id="local-6989586621681100095"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100095"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100094"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100095"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100094"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100093"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100092"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621681099386"><span class="annot"><span class="annottext">collectScopeInfo :: Program tyname name uni fun NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099386"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099385"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099385"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099385"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-292"></span></pre></body></html>